From 48fb5e1a6a14c09b81d8291faecaa2a0016f1b0a Mon Sep 17 00:00:00 2001
From: Lubomir Rintel <lkundrak@v3.sk>
Date: Thu, 12 Jan 2017 08:54:39 +0100
Subject: [PATCH] udev: split the uaccess rule into a separate file

The seat tag for uaccess devices is added in 71-seat.rules; the 80-* rule is
too late for that.

Also, this makes it easy for distributions to exclude the rule that is
not relevant to them; still both being installed at the same time
doesn't cause any trouble.
---
 Makefile                      | 2 ++
 udev/rules.d/60-minipro.rules | 1 +
 udev/rules.d/80-minipro.rules | 1 -
 3 files changed, 3 insertions(+), 1 deletion(-)
 create mode 100644 udev/rules.d/60-minipro.rules

diff --git a/Makefile b/Makefile
index 2162ef2..a190dc1 100644
--- a/Makefile
+++ b/Makefile
@@ -50,6 +50,7 @@ install:
 	cp $(MINIPRO) $(BIN_DIR)
 	cp $(MINIPRO_QUERY_DB) $(BIN_DIR)
 	cp $(MINIPROHEX) $(BIN_DIR)
+	cp udev/rules.d/60-minipro.rules $(UDEV_RULES_DIR)
 	cp udev/rules.d/80-minipro.rules $(UDEV_RULES_DIR)
 	cp bash_completion.d/minipro $(COMPLETIONS_DIR)
 	cp man/minipro.1 $(MAN_DIR)
@@ -58,6 +59,7 @@ uninstall:
 	rm -f $(BIN_DIR)/$(MINIPRO)
 	rm -f $(BIN_DIR)/$(MINIPRO_QUERY_DB)
 	rm -f $(BIN_DIR)/$(MINIPROHEX)
+	rm -f $(UDEV_RULES_DIR)/60-minipro.rules
 	rm -f $(UDEV_RULES_DIR)/80-minipro.rules
 	rm -f $(COMPLETIONS_DIR)/minipro
 	rm -f $(MAN_DIR)/minipro.1
diff --git a/udev/rules.d/60-minipro.rules b/udev/rules.d/60-minipro.rules
new file mode 100644
index 0000000..4b69fb4
--- /dev/null
+++ b/udev/rules.d/60-minipro.rules
@@ -0,0 +1 @@
+SUBSYSTEMS=="usb", ATTRS{idVendor}=="04d8", ATTRS{idProduct}=="e11c", TAG+="uaccess"
diff --git a/udev/rules.d/80-minipro.rules b/udev/rules.d/80-minipro.rules
index 1b32040..b1976fc 100644
--- a/udev/rules.d/80-minipro.rules
+++ b/udev/rules.d/80-minipro.rules
@@ -1,2 +1 @@
-SUBSYSTEMS=="usb", ATTRS{idVendor}=="04d8", ATTRS{idProduct}=="e11c", TAG+="uaccess"
 SUBSYSTEMS=="usb", ATTRS{idVendor}=="04d8", ATTRS{idProduct}=="e11c", MODE="0660", GROUP="plugdev"
-- 
2.9.3

